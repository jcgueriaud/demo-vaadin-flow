<custom-style>
    <style>
        html {
            --lumo-font-family: "Open Sans", sans-serif;
            --primary-color: var(--lumo-primary-color);
            --app-layout-focus-color: var(--lumo-primary-text-color);
            --app-layout-bar-background-color: var(--lumo-primary-color);
            --app-menu-background-color: var(--lumo-primary-contrast-color);
            --app-menu-selected-bg-color: var(--lumo-contrast-10pct);
        }

        html {
            --custom-color: red;
        }
        [theme~="dark"] {
            --custom-color: pink;
        }
    </style>
</custom-style>



<dom-module theme-for="hello-world" id="custom-hello-world">
    <template>
        <style>
            /* Works but i need to define an extra variable */
            p {
                color:var(--custom-color);
            }
            /* does not work */
            [theme~="dark"] p {
                background-color:grey;
            }
        </style>
    </template>
</dom-module>